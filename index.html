<!DOCTYPE html>
<html lang="it">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="apple-touch-icon" sizes="180x180" href="img/icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="96x96" href="img/icons/favicon-96x96.png">
    <link rel="manifest" href="site.webmanifest">
    <meta name="theme-color" content="#ff6b35">
    <title>ChocoFit Academy</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <!-- Background Image - Fixed -->
    <div class="background-image"></div>

    <!-- ==================== WELCOME SCREEN ==================== -->
    <div id="welcome-screen" class="screen">
        <div class="welcome-container">
            <img src="img/LogoChoco.png" alt="ChocoFit Logo" class="welcome-logo">
            <h1 class="welcome-title">Benvenuto in ChocoFit!</h1>
            <p class="welcome-text">Crea la tua scheda di allenamento personalizzata e portala sempre con te.</p>
            <div class="welcome-features">
                <div class="welcome-feature">
                    <span class="feature-icon">üìã</span>
                    <span>Crea i tuoi giorni</span>
                </div>
                <div class="welcome-feature">
                    <span class="feature-icon">üí™</span>
                    <span>Aggiungi esercizi</span>
                </div>
                <div class="welcome-feature">
                    <span class="feature-icon">‚è±Ô∏è</span>
                    <span>Timer integrato</span>
                </div>
                <div class="welcome-feature">
                    <span class="feature-icon">üíæ</span>
                    <span>Salvataggio locale</span>
                </div>
            </div>
            <button id="start-setup-btn" class="welcome-btn">
                <span>Crea il tuo allenamento</span>
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M5 12h14M12 5l7 7-7 7"/>
                </svg>
            </button>
            <div class="welcome-import">
                <p>Hai gi√† una scheda?</p>
                <label class="import-btn">
                    <input type="file" id="import-welcome" accept=".chocofit" hidden>
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                        <polyline points="17 8 12 3 7 8"/>
                        <line x1="12" y1="3" x2="12" y2="15"/>
                    </svg>
                    <span>Importa .chocofit</span>
                </label>
            </div>
        </div>
    </div>

    <!-- ==================== SETUP SCREEN ==================== -->
    <div id="setup-screen" class="screen">
        <div class="setup-header">
            <img src="img/LogoChoco.png" alt="Logo" class="setup-logo">
            <h1 class="setup-title">Configura Scheda</h1>
        </div>

        <div class="setup-container">
            <!-- Days List -->
            <div id="days-list" class="days-list">
                <!-- Days will be added here dynamically -->
            </div>

            <!-- Add Day Button -->
            <button id="add-day-btn" class="add-day-btn">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <circle cx="12" cy="12" r="10"/>
                    <line x1="12" y1="8" x2="12" y2="16"/>
                    <line x1="8" y1="12" x2="16" y2="12"/>
                </svg>
                <span>Aggiungi Giorno</span>
            </button>
            
            <!-- Cardiac Load Toggle -->
            <div class="settings-card">
                <div class="settings-card-header">
                    <span class="settings-icon">‚ù§Ô∏è</span>
                    <span class="settings-title">Carico Cardiaco</span>
                </div>
                <div class="settings-card-body">
                    <p class="settings-description">Traccia il tuo carico cardiaco settimanale con target +10%</p>
                    <label class="toggle-label">
                        <span>Attiva tracking</span>
                        <div class="toggle-switch">
                            <input type="checkbox" id="cardiac-toggle">
                            <span class="toggle-slider"></span>
                        </div>
                    </label>
                </div>
            </div>
        </div>

        <!-- Setup Footer -->
        <div class="setup-footer">
            <button id="start-workout-btn" class="start-workout-btn" disabled>
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polygon points="5 3 19 12 5 21 5 3"/>
                </svg>
                <span>Inizia Allenamento</span>
            </button>
            <div class="setup-actions">
                <button id="export-btn" class="action-btn" title="Esporta scheda">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                        <polyline points="7 10 12 15 17 10"/>
                        <line x1="12" y1="15" x2="12" y2="3"/>
                    </svg>
                </button>
                <label class="action-btn" title="Importa scheda">
                    <input type="file" id="import-setup" accept=".chocofit" hidden>
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                        <polyline points="17 8 12 3 7 8"/>
                        <line x1="12" y1="3" x2="12" y2="15"/>
                    </svg>
                </label>
                <button id="delete-all-btn" class="action-btn delete" title="Cancella scheda">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="3 6 5 6 21 6"/>
                        <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                        <line x1="10" y1="11" x2="10" y2="17"/>
                        <line x1="14" y1="11" x2="14" y2="17"/>
                    </svg>
                </button>
            </div>
        </div>
    </div>

    <!-- ==================== WORKOUT APP ==================== -->
    <div id="app-screen" class="screen">
        <div class="app">
            <!-- Header + Navigation -->
            <header class="header-nav">
                <img src="img/LogoChoco.png" alt="Logo" class="header-logo">
                <nav class="nav" id="nav-container">
                    <!-- Navigation buttons will be added dynamically -->
                </nav>
                <button id="settings-btn" class="settings-btn" title="Configura scheda">
                    <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="3"/>
                        <path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/>
                    </svg>
                </button>
            </header>

            <!-- Timer Section -->
            <div class="timer-section">
                <div class="timer-card">
                    <div class="timer-input-group">
                        <input type="number" class="timer-input" id="timer-input" value="60" min="1" max="600">
                        <span class="timer-unit">sec</span>
                    </div>
                    <div class="timer-display" id="timer-display">01:00</div>
                    <div class="timer-controls">
                        <button class="timer-btn start" id="timer-start" title="Start">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="#4CAF50" stroke="none">
                                <polygon points="5 3 19 12 5 21 5 3"></polygon>
                            </svg>
                        </button>
                        <button class="timer-btn stop" id="timer-stop" title="Stop">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="#f44336" stroke="none">
                                <rect x="6" y="6" width="12" height="12"></rect>
                            </svg>
                        </button>
                        <button class="timer-btn reset" id="timer-reset" title="Reset">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                                <polyline points="23 4 23 10 17 10"></polyline>
                                <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Sessions Container -->
            <main class="sessions-container" id="sessions-container">
                <!-- Sessions will be added dynamically -->
            </main>
            
            <!-- Floating Cardiac Button -->
            <button id="cardiac-fab" class="cardiac-fab hidden">
                <span class="cardiac-fab-icon">‚ù§Ô∏è</span>
                <span class="cardiac-fab-value" id="cardiac-fab-value">--</span>
            </button>
        </div>
    </div>
    
    <!-- ==================== CARDIAC LOAD PAGE ==================== -->
    <div id="cardiac-screen" class="screen">
        <div class="cardiac-page">
            <div class="cardiac-header">
                <button id="cardiac-back-btn" class="back-btn">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M19 12H5M12 19l-7-7 7-7"/>
                    </svg>
                </button>
                <h1 class="cardiac-title">‚ù§Ô∏è Carico Cardiaco</h1>
            </div>
            
            <div class="cardiac-content">
                <!-- Weekly Target Setup -->
                <div class="cardiac-card">
                    <div class="cardiac-card-title">Target Settimanale</div>
                    <div class="cardiac-input-row">
                        <div class="cardiac-input-group">
                            <label>Media settimana scorsa</label>
                            <input type="number" id="cardiac-last-week" placeholder="0" min="0" step="0.1">
                        </div>
                        <div class="cardiac-arrow">‚Üí</div>
                        <div class="cardiac-input-group">
                            <label>Target (+10%)</label>
                            <div class="cardiac-target-display" id="cardiac-target-display">--</div>
                        </div>
                    </div>
                </div>
                
                <!-- Today's Target -->
                <div class="cardiac-card highlight">
                    <div class="cardiac-card-title">Oggi devi fare</div>
                    <div class="cardiac-today-value" id="cardiac-today-target">--</div>
                </div>
                
                <!-- Weekly Progress -->
                <div class="cardiac-card">
                    <div class="cardiac-card-title">Questa Settimana</div>
                    <div class="cardiac-week-grid" id="cardiac-week-grid">
                        <!-- Days will be generated -->
                    </div>
                    <div class="cardiac-summary">
                        <div class="cardiac-summary-item">
                            <span class="label">Totale fatto</span>
                            <span class="value" id="cardiac-total-done">0</span>
                        </div>
                        <div class="cardiac-summary-item">
                            <span class="label">Rimasto</span>
                            <span class="value" id="cardiac-remaining">--</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ==================== ADD DAY MODAL ==================== -->
    <div id="day-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modal-title">Nuovo Giorno</h2>
                <button class="modal-close" id="modal-close">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="day-name">Giorno della settimana</label>
                    <select id="day-name" class="form-select">
                        <option value="">Seleziona un giorno...</option>
                        <option value="Luned√¨">Luned√¨</option>
                        <option value="Marted√¨">Marted√¨</option>
                        <option value="Mercoled√¨">Mercoled√¨</option>
                        <option value="Gioved√¨">Gioved√¨</option>
                        <option value="Venerd√¨">Venerd√¨</option>
                        <option value="Sabato">Sabato</option>
                        <option value="Domenica">Domenica</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Scegli un'emoji</label>
                    <div class="emoji-grid" id="emoji-grid">
                        <button type="button" class="emoji-btn" data-emoji="üèãÔ∏è">üèãÔ∏è</button>
                        <button type="button" class="emoji-btn" data-emoji="üí™">üí™</button>
                        <button type="button" class="emoji-btn" data-emoji="üî•">üî•</button>
                        <button type="button" class="emoji-btn" data-emoji="‚ö°">‚ö°</button>
                        <button type="button" class="emoji-btn" data-emoji="ü¶µ">ü¶µ</button>
                        <button type="button" class="emoji-btn" data-emoji="üéØ">üéØ</button>
                        <button type="button" class="emoji-btn" data-emoji="üöÄ">üöÄ</button>
                        <button type="button" class="emoji-btn" data-emoji="üí•">üí•</button>
                    </div>
                    <input type="hidden" id="day-emoji" value="">
                </div>
            </div>
            <div class="modal-footer">
                <button id="modal-cancel" class="modal-btn cancel">Annulla</button>
                <button id="modal-save" class="modal-btn save">Salva</button>
            </div>
        </div>
    </div>

    <!-- ==================== ADD EXERCISE MODAL ==================== -->
    <div id="exercise-modal" class="modal hidden">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="exercise-modal-title">Nuovo Esercizio</h2>
                <button class="modal-close" id="exercise-modal-close">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="exercise-name">Nome esercizio</label>
                    <input type="text" id="exercise-name" placeholder="es. Panca Piana Manubri">
                </div>
                
                <!-- Serie - sempre visibile -->
                <div class="form-group">
                    <label for="exercise-sets">Serie</label>
                    <input type="number" id="exercise-sets" value="3" min="1" max="20">
                </div>
                
                <!-- Toggle Progressive -->
                <div class="form-group">
                    <label class="toggle-label">
                        <span>Ripetizioni progressive</span>
                        <div class="toggle-switch">
                            <input type="checkbox" id="exercise-progressive">
                            <span class="toggle-slider"></span>
                        </div>
                    </label>
                    <span class="toggle-hint">Es: 14, 15, 16, 17 invece di 4√ó14</span>
                </div>
                
                <!-- Standard Reps (shown when progressive is OFF) -->
                <div id="standard-reps-group" class="form-group">
                    <label for="exercise-reps">Ripetizioni</label>
                    <input type="number" id="exercise-reps" value="10" min="1" max="100">
                </div>
                
                <!-- Progressive Reps (shown when progressive is ON) -->
                <div id="progressive-reps-group" class="form-row hidden">
                    <div class="form-group">
                        <label for="exercise-reps-min">Reps Min</label>
                        <input type="number" id="exercise-reps-min" value="10" min="1" max="100">
                    </div>
                    <div class="form-group">
                        <label for="exercise-reps-max">Reps Max</label>
                        <input type="number" id="exercise-reps-max" value="12" min="1" max="100">
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="exercise-weight">Peso (kg)</label>
                        <input type="number" id="exercise-weight" value="0" min="0" step="0.5">
                    </div>
                    <div class="form-group">
                        <label for="exercise-rest">Riposo (sec)</label>
                        <input type="number" id="exercise-rest" value="60" min="0" max="600" step="5">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button id="exercise-modal-cancel" class="modal-btn cancel">Annulla</button>
                <button id="exercise-modal-save" class="modal-btn save">Salva</button>
            </div>
        </div>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast hidden">
        <span id="toast-message"></span>
    </div>

    <!-- Confirm Modal -->
    <div id="confirm-modal" class="modal hidden">
        <div class="modal-content confirm-modal-content">
            <div class="modal-body">
                <p id="confirm-message" class="confirm-message">Sei sicuro?</p>
            </div>
            <div class="modal-footer">
                <button id="confirm-cancel" class="modal-btn cancel">Annulla</button>
                <button id="confirm-ok" class="modal-btn save">Elimina</button>
            </div>
        </div>
    </div>

    <!-- Input Modal -->
    <div id="input-modal" class="modal hidden">
        <div class="modal-content confirm-modal-content">
            <div class="modal-header">
                <h2 id="input-modal-title">Modifica</h2>
                <button class="modal-close" id="input-modal-close">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <input type="number" id="input-modal-value" class="form-input" min="1">
                </div>
            </div>
            <div class="modal-footer">
                <button id="input-modal-cancel" class="modal-btn cancel">Annulla</button>
                <button id="input-modal-save" class="modal-btn save">Salva</button>
            </div>
        </div>
    </div>

    <!-- Dexie.js for IndexedDB -->
    <script src="https://unpkg.com/dexie@3.2.4/dist/dexie.min.js"></script>
    <script src="script.js"></script>
</body>

</html>
